---
title: "تحلیل داده‌های گسسته با نمودارهای گرافیکی مختلف"
author: "امیرعلی سطوتی "
output:
  bookdown::pdf_document2:
    latex_engine: xelatex
    toc: true
    number_sections: true
    highlight: tango
header-includes:
  # ابتدا بسته titlesec بارگذاری شود
  - \usepackage{titlesec}  # برای تغییر فرمت عنوان‌ها
  - \usepackage{fancyhdr}  # برای هدر و فوتر سفارشی
  - \usepackage{amsmath}  # برای فرمول‌ها
  - \usepackage{hyperref}  # برای لینک‌ها
  - \usepackage{bidi}  # برای پشتیبانی از نوشتار دوطرفه (راست‌چین)
  - \usepackage{xepersian}  # برای پشتیبانی از متن فارسی
  - \settextfont{Arial}  # فونت برای متن فارسی
  - \setlatintextfont{Arial}  # فونت برای متن لاتین
  - \usepackage{graphicx}  # برای بارگذاری تصاویر
  - \pagestyle{fancy}  # استفاده از هدر و فوتر سفارشی
  - \fancyhf{}  # پاک کردن هدر و فوتر پیش‌فرض
  - \fancyhead[L]{\thetitle}  # عنوان در سمت چپ هدر
  - \fancyhead[C]{\author}  # نویسنده در وسط هدر
  - \fancyhead[R]{\today}  # تاریخ در سمت راست هدر
  - \geometry{top=2.5cm, bottom=2.5cm, left=2.5cm, right=2.5cm}  # تنظیم حاشیه‌ها
  - \titleformat{\section}[block]{\normalfont\Huge\bfseries}{\thesection}{2em}{}  # برای بزرگ کردن عنوان‌ها
  - \titleformat{\subsection}[block]{\normalfont\large\bfseries}{\thesubsection}{1em}{}  # تنظیم فرمت زیرعنوان‌ها
  - \usepackage{fontspec}  # بسته برای تنظیم فونت‌ها
  - \fontsize{16}{18}\selectfont
  - \setlatintextfont{Arial}  # تنظیم فونت برای متن لاتین
---


```{r setup-1, include=FALSE}
library(RTLknitr)
knitr::opts_chunk$set(echo = TRUE)

markdown_rtl()
```

# مقدمه

در دنیای داده‌ها، تحلیل و تجسم اطلاعات اهمیت زیادی دارد. داده‌های گسسته، مانند شمارش افراد یا محصولات، نیاز به تحلیل گرافیکی دارند که نمودارهای میله‌ای یکی از ابزارهای مهم برای این کار هستند. این نمودارها برای نمایش توزیع داده‌ها و مقایسه میان گروه‌ها مفید هستند. هدف این پروژه، آموزش روش‌های تحلیل گرافیکی داده‌های گسسته با استفاده از زبان برنامه‌نویسی و ابزارهای مختلف است تا کاربران بتوانند داده‌های خود را به‌طور مؤثری تجزیه و تحلیل کنند.

لطفاً توجه فرمایید که این فایل از نسخه‌ای پیروی می‌کند که در آن از کتابخانه‌ی Plotly برای ترسیم نمودارها در فرمت PDF استفاده نشده است. برای دسترسی به نسخه‌ی HTML این فایل و مشاهده‌ی نمودارهای تعاملی، می‌توانید به مخزن گیت‌هاب مربوطه مراجعه نمایید.

## توضیح داده‌ها

### Data for Bar chart

داده‌های مورد استفاده در این پروژه مربوط به مسافران کشتی Titanic است. این داده‌ها شامل اطلاعات مختلفی از جمله شناسه مسافر، نام مسافر، بندر سوار شدن (Embarked) و وضعیت نجات (Survived) می‌باشد. این اطلاعات به‌طور خاص به تحلیل وضعیت مسافران، بررسی میزان نجات‌یافتگان و تحلیل توزیع مسافران براساس بندرهای مختلف سوار شدن کمک می‌کند.

هدف از استفاده از این داده‌ها در پروژه، تحلیل گرافیکی داده‌های گسسته و استفاده از نمودارهای مختلف به منظور نمایش و مقایسه ویژگی‌های مختلف مسافران مانند وضعیت نجات و بندر سوار شدن است.

[دانلود دیتاست](https://www.kaggle.com/datasets/pranjalpandey12/data-for-bar-chart)

### dataset (Spotify Tracks Dataset)

این مجموعه داده شامل ویژگی‌های مختلف از آهنگ‌های اسپاتیفای در 125 ژانر متفاوت است. هر آهنگ دارای ویژگی‌هایی مانند مدت زمان، محبوبیت، انرژی، رقص‌پذیری و نوع محتوا می‌باشد. همچنین، اطلاعاتی مانند نام آهنگ، آلبوم، هنرمندان و ویژگی‌های صوتی مانند صدای گفتاری، آکوستیک بودن و لایو بودن در دسترس است. این داده‌ها می‌توانند برای ایجاد سیستم‌های توصیه‌گر، تحلیل ویژگی‌های موسیقی و کلاس‌بندی آهنگ‌ها بر اساس ژانر استفاده شوند. در این تحلیل‌ها از نمودارهای میله‌ای، نمودار درختی و نمودار تار عنکبوتی برای نمایش ویژگی‌ها و مقایسه داده‌ها استفاده شد.

[دانلود دیتاست اسپاتیفای](https://www.kaggle.com/datasets/maharshipandya/-spotify-tracks-dataset)

---

# نمودار میله‌ای

## ویژگی‌ها و چالش‌های استفاده از نمودارهای میله‌ای

### نقاط قوت نمودار میله‌ای
- رسم آسان و تفسیر قابل فهم
- نمایش دقیق فراوانی، درصد یا سهم هر گروه
- امکان مقایسه‌ی مستقیم بین گروه‌ها
- کاربرد گسترده در گزارش‌نویسی و آموزش
- امکان نمایش داده‌های کیفی (بسیار مناسب برای نمایش داده‌هایی مانند جنسیت، وضعیت تحصیلی، یا محل سکونت)

### نقاط ضعف و محدودیت‌های نمودار میله‌ای
- تعداد زیاد رده‌ها (گروه‌ها) باعث شلوغی و کاهش خوانایی می‌شود
- رابطه‌ی بین متغیرها را نشان نمی‌دهد
- در مورد توزیع احتمالی داده‌ها اطلاعاتی نمی‌دهد
- مناسب داده‌های پیوسته نیست

## روش‌های پیاده‌سازی کد برای رسم نمودارهای میله‌ای

```{r setup, include=FALSE}
library(RColorBrewer)
library(ggplot2)
library(plotly)

```


```{r}

#Data_Bar <- as.data.frame(read.csv(file.choose(), header = TRUE))
Data_Bar <- read.csv("C:/Users/WIN10/Desktop/Data for Bar chart.csv")
head(Data_Bar)

```

### سوال اول

چند نفر در هر بندر سوار شده‌اند؟ از نمودار میله‌ای استفاده می‌کنیم

```{r}
embark_freq <- table(Data_Bar$Embarked)
embark_freq
barplot(height = embark_freq,
        names.arg = names(embark_freq),
        col = c(2,5,56),
        ylab = "Number of Passengers",
        main = "Number of Passengers by Embarkation Port",
        horiz = FALSE)

```

#### تفسیر اول

این نمودار میله‌ای تعداد مسافران را بر اساس سه بندر مختلف نشان می‌دهد:

بندر Cherbourg (C)

بندر Queenstown (Q)

بندر Southampton (S)

نکات اصلی: بندر Southampton بیشترین تعداد مسافر را دارد.

بندر  Queenstow تعداد کمتری مسافر دارد.

### سوال دوم

تعداد افرادی که نجات یافته اند ؟ برای رسم نمودار تعداد نجات‌یافتگان، ابتدا باید وضعیت نجات مسافران را بر اساس ستون Survived طبقه‌بندی کرده و سپس نمودار گرافیکی بسازیم. برای این کار از قابلیت‌های پیشرفته ggplot2 و امکانات تعاملی plotly استفاده می‌شود.

```{r}
library(ggplot2)

Data_Bar$Status <- ifelse(Data_Bar$Survived == 1, "Survived", "Deceased")

summary_table <- as.data.frame(table(Data_Bar$Status))
colnames(summary_table) <- c("Status", "Count")

ggplot(summary_table, aes(x = Status, y = Count, fill = Status)) +
  geom_bar(stat = "identity", width = 0.6) +
  scale_fill_manual(values = c("Deceased" = "tomato", "Survived" = "seagreen")) +
  labs(
    title = "Survival Status Bar Chart",
    x = "Survival Status",
    y = "Count"
  ) +
  theme_minimal() +
  theme(
    text = element_text(size = 13),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
    legend.position = "none"
  )

```

#### تفسیر دوم

نمودار وضعیت نجات و درگذشتگان کشتی Titanic نشان می‌دهد که تعداد افراد درگذشته به‌طور قابل‌توجهی بیشتر از نجات‌یافتگان است. میله‌های قرمز مربوط به درگذشتگان و میله‌های سبز نشان‌دهنده نجات‌یافتگان هستند، که کمتر از درگذشتگان بوده و ممکن است تحت تأثیر عوامل مختلفی مانند موقعیت کشتی و شرایط فردی قرار داشته باشد. میله‌های بلندتر نشان‌دهنده تعداد بیشتر و میله‌های کوتاه‌تر نشان‌دهنده تعداد کمتر هستند.

---

# نمودارهای میله‌ای دایره‌ای

نمودارهای میله‌ای دایره‌ای مشابه نمودارهای میله‌ای معمولی هستند، با این تفاوت که داده‌ها در یک نمای دایره‌ای نمایش داده می‌شوند. این نمودارها برای مقایسه ویژگی‌های مختلف در داده‌های چندبعدی مفید و بصری جذاب هستند. با این حال، وقتی تعداد داده‌ها زیاد باشد، نمودار شلوغ می‌شود و مقایسه دقیق مقادیر مشکل می‌شود. همچنین، با افزایش تعداد بخش‌ها، خوانایی کاهش یافته و برای نمایش روند زمانی مناسب نیستند.

## توضیح داده‌ها

این مجموعه داده شامل ویژگی‌های مختلف از آهنگ‌های اسپاتیفای در 125 ژانر متفاوت است. هر آهنگ دارای ویژگی‌هایی مانند مدت زمان، محبوبیت، انرژی، رقص‌پذیری، و نوع محتوا می‌باشد. همچنین، اطلاعاتی مانند نام آهنگ، آلبوم، و هنرمندان و ویژگی‌های صوتی مانند صدای گفتاری، آکوستیک بودن، و لایو بودن در دسترس است. این داده‌ها می‌توانند برای ایجاد سیستم‌های توصیه‌گر، تحلیل ویژگی‌های موسیقی و کلاس‌بندی آهنگ‌ها بر اساس ژانر استفاده شوند.

## پیاده‌سازی کد برای رسم نمودار میله‌ای دایره‌ای

### سوال اول

آیا می‌توان یک نمودار قطبی تعاملی از میانگین محبوبیت در هر ژانر رسم کرد؟ بله

```{r}
#Data_song <- as.data.frame(read.csv(file.choose(), header = TRUE))
Data_song <- read.csv("C:/Users/WIN10/Desktop/dataset.csv")

```

```{r}
length(unique(Data_song$track_genre))
genre_mapping <- list(
  "Pop" = c("pop", "power-pop", "pop-film", "romance", "show-tunes", "swedish", "synth-pop"),
  "Rock" = c("rock", "hard-rock", "punk", "punk-rock", "grunge", "psych-rock", "alt-rock", "alternative", "rock-n-roll", "rockabilly", "j-rock"),
  "Hip-Hop/Rap" = c("hip-hop", "r-n-b", "rap"),
  "Electronic/Dance" = c("techno", "edm", "trance", "electro", "house", "dubstep", "deep-house", "minimal-techno", "dance", "detroit-techno", "hardstyle", "party"),
  "Classical" = c("classical", "piano", "opera", "new-age"),
  "Jazz/Blues" = c("jazz", "blues", "soul", "funk"),
  "World" = c("latin", "reggaeton", "salsa", "samba", "brazil", "mpb", "afrobeat", "german", "iranian", "malay", "pagode", "tango", "turkish", "latino", "world-music"),
  "Metal" = c("metal", "heavy-metal", "black-metal", "death-metal", "metalcore", "grindcore", "hardcore"),
  "R&B/Soul" = c("r-n-b", "soul", "gospel"),
  "Country" = c("country", "honky-tonk", "bluegrass", "sertanejo"),
  "Folk/Acoustic" = c("folk", "acoustic", "singer-songwriter", "indie", "indie-pop", "sad", "songwriter"),
  "Children/Other" = c("children", "comedy", "anime", "disney", "kids"),
  "Chill" = c("chill", "ambient", "club", "breakbeat", "deep-house", "dub", "dubstep", "sleep"),
  "Cantopop/Asian Pop" = c("cantopop", "j-pop", "k-pop", "mandopop", "j-idol", "j-dance"),
  "Chicago House/House" = c("chicago-house", "house", "garage"),
  "Disco/Funk" = c("disco", "funk", "groove", "soul"),
  "Indie/Alternative" = c("indie", "indie-pop", "alternative", "indie-rock", "british", "goth", "industrial"),
  "Reggae/Roots" = c("reggae", "dancehall", "dub", "ska")
)
map_genre <- function(genre) {
  for (group in names(genre_mapping)) {
    if (genre %in% genre_mapping[[group]]) {
      return(group)
    }
  }
  return("Other")  
}
Data_song$super_genre <- sapply(Data_song$track_genre, map_genre)
#write.csv(Data_song, "reduced_genres.csv", row.names = FALSE)
table(Data_song$super_genre)
```
 

تعداد ژانرهای اصلی در داده‌ها ۱۱۴ مورد بود که با استفاده از کد بالا به 19 ژانر کلی‌تر تبدیل شدند

```{r}
library(ggplot2)
library(RColorBrewer)

df_summary <- aggregate(popularity ~ super_genre, data = Data_song, FUN = mean)
df_summary$super_genre <- factor(df_summary$super_genre,
                                 levels = df_summary$super_genre[order(-df_summary$popularity)])
n_colors <- length(unique(df_summary$super_genre))
colors <- colorRampPalette(brewer.pal(12, "Set3"))(n_colors)

ggplot(df_summary, aes(x = super_genre, y = popularity, fill = super_genre)) +
  geom_bar(stat = "identity", width = 1, color = "white") +
  coord_polar() +
  scale_fill_manual(values = colors) +
  labs(
    title = "Average Track Popularity by Genre",
    x = NULL,
    y = NULL
  ) +
  theme_minimal() +
  theme(
    axis.text.y = element_blank(),
    axis.text.x = element_text(size = 10, face = "bold"),
    axis.ticks = element_blank(),
    panel.grid = element_blank(),
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold", size = 15)
  )

```

این کد با استفاده از Plotly یک نمودار قطبی تعاملی رسم می‌کند که میانگین محبوبیت ترک‌ها را برای هر ژانر `super_genre` نمایش می‌دهد. رنگ‌ها به‌صورت داینامیک تولید شده و با نگه‌داشتن ماوس اطلاعات ژانر و محبوبیت قابل مشاهده است.

#### تفسیر نمودار

- میله‌های دایره‌ای نشان‌دهنده‌ی محبوبیت هر ژانر هستند.
- بیشترین محبوبیت مربوط به سبک **R&B/Soul** است.
- کمترین میزان محبوبیت مربوط به سبک **Jazz/Blues** است.

---

# نمودار درختی

نمودار درختی یک مدل گرافیکی است که برای نمایش روابط سلسله‌مراتبی یا تقسیم‌بندی داده‌ها استفاده می‌شود. هر گره نمایانگر یک نقطه تصمیم‌گیری یا داده است و شاخه‌ها مسیرهای ارتباطی بین گره‌ها را نشان می‌دهند.

## ویژگی‌ها و چالش‌های استفاده از نمودار درختی

### نقاط قوت نمودار درختی

- مقایسه رده‌ها بر اساس حجم
- ایجاد زیرگروه‌ها و رده‌بندی آن‌ها بر اساس رنگ‌های مشابه
- قرار دادن تعداد زیاد رده‌ها در یک فضای فشرده

### نقاط ضعف نمودار درختی

- برچسب مستطیل‌های کوچک به سختی قابل مشاهده است
- تغییرات زمانی متغیرها را نشان نمی‌دهد
- در مورد توزیع احتمالی داده‌ها اطلاعاتی نمی‌دهد

## نحوه پیاده‌سازی نمودار درختی

### سوال

برای مقایسه محبوبیت ژانرها و زیرژانرهای موسیقی با استفاده از نمودار درختی، چه کدی باید نوشته شود؟
```{r}
library(treemap)
library(RColorBrewer)
Data_song_summary <- aggregate(popularity ~ super_genre+track_genre, data = Data_song, FUN = mean)
Data_song_summary$super_genre <- as.factor(Data_song_summary$super_genre)
Data_song_summary$track_genre <- as.factor(Data_song_summary$track_genre)
treemap(Data_song_summary, 
        index = c("super_genre", "track_genre"),  
        vSize = "popularity", 
        type = "index", 
        border.col = c("black", "white"), 
        border.lwds = c(3, 2),           
        palette = "Set1",  
        title = "Treemap")
```

```{r}
library(treemapify)
library(ggplot2)
ggplot(Data_song_summary, aes(area = popularity, fill = super_genre, 
                              label = track_genre, subgroup = super_genre)) +
  geom_treemap() +
  geom_treemap_subgroup_border(colour = "white", size = 5) +
  geom_treemap_subgroup_text(place = "centre", grow = TRUE,
                             alpha = 0.25, colour = "black",
                             fontface = "italic") +
  geom_treemap_text(colour = "white", place = "centre",
                    size = 15, grow = TRUE) +
  theme(legend.position = "none") +
  ggtitle("Treemap of Song Genres by Popularity")
```

#### تفسیر نمودار درختی
می‌توان نتیجه گرفت که ژانرهای پاپ، راک و موسیقی‌های کودکانه از محبوبیت بیشتری برخوردار هستند، در حالی که ژانرهای خاص مانند "opera" و "gospel" از محبوبیت کمتری برخوردارند.

---

# نمودار گرمایی

نمودار گرمایی یک روش تصویری برای نمایش داده‌ها به‌صورت ماتریسی است که در آن از رنگ‌ها برای نشان دادن مقادیر مختلف استفاده می‌شود. معمولاً رنگ‌های تیره برای مقادیر بالا و رنگ‌های روشن برای مقادیر پایین به کار می‌روند، که این ابزار به شناسایی روابط و الگوهای داده‌ها کمک می‌کند.

## ویژگی‌ها و چالش‌های استفاده از نمودار گرمایی

### نقاط قوت نمودار گرمایی

- مناسب داده‌های حجیم
- نمایش الگوها، روابط و روندها
- نمایش حجم یا فراوانی با طیفی از رنگ‌ها
- مشخص کردن مقادیر گمشده با رنگ سفید

### نقاط ضعف نمودار گرمایی

- مقیاس‌بندی اشتباه می‌تواند تفسیر را سخت کند
- زیاد بودن رده‌های هم‌حجم تفسیر را سخت کند

## پیاده‌سازی کد نمودار گرمایی

### سوال

آیا بین ویژگی‌های مختلف خودروها در داده‌های mtcars همبستگی‌هایی وجود دارد؟

```{r}
data <- as.matrix(mtcars)
data=scale(data)
heatmap(data,Colv = NA, Rowv = NA)
```

```{r warning=FALSE}
library(ggplot2)
library(hrbrthemes)
library(viridis)

data <- as.matrix(mtcars)
data_scaled <- scale(data)
data_long <- as.data.frame(as.table(data_scaled))
ggplot(data_long, aes(Var2, Var1, fill = Freq)) + 
  geom_tile() +
  scale_fill_gradient(low = "white", high = "blue") +
  theme_minimal() +
  labs(title = "Heatmap of mtcars Dataset", y = "Cars", x = "Features")

```
#### تفسیر نمودار گرمایی
می‌توان تحلیل کرد که برای هر خودرو، مقادیر مختلف ویژگی‌ها چه تأثیری در روابط بین ویژگی‌ها دارند. برای مثال، خودروهایی که در بعضی ویژگی‌ها رنگ تیره‌تری دارند، ممکن است مقادیر بالاتری در آن ویژگی‌ها داشته باشند. این نمودار می‌تواند به شناسایی الگوهای مختلف در داده‌های خودروها کمک کند.

---

# نمودار تار عنکبوتی

نمودار تار عنکبوتی یا راداری ابزاری است که برای مقایسه همزمان چند متغیر به کار می‌رود. در این نمودار، هر ویژگی روی یک محور جداگانه قرار می‌گیرد و با وصل کردن نقاط، یک شکل چندضلعی تشکیل می‌شود که نقاط قوت و ضعف گزینه‌های مختلف را به خوبی نشان می‌دهد.

## ویژگی‌ها و چالش‌های استفاده از نمودار تار عنکبوتی

### نقاط قوت نمودار تار عنکبوتی

- مقایسه داده‌های کمی با رده‌بندی آن‌ها
- مقایسه هم‌زمان چندین متغیر
- نمایش الگوها و روندها
- تشخیص نقاط دورافتاده

### نقاط ضعف نمودار تار عنکبوتی

- حساسیت به ترتیب معرفی متغیرها
- تفسیر دشوار در صورت زیاد بودن تعداد متغیرها

## پیاده‌سازی کد نمودار تارعنکبوتی

### سوال

کدام ویژگی از میان `duration_ms`، `energy`، `danceability`، `popularity`، `liveness` و `tempo` در آهنگ‌های ژانر Pop بیشترین تنوع را بین آهنگ‌ها نشان می‌دهد؟

```{r message=FALSE, warning=FALSE}
library(fmsb)
library(dplyr)

ndata <- Data_song[, c("duration_ms", "energy", "danceability", "popularity", "track_genre", "super_genre", "track_name","liveness","tempo")]
df_new <- ndata[ndata$super_genre == "Pop", ]
set.seed(123)
df_new <- df_new[sample(nrow(df_new), 10), ]
pop_data <- df_new[, c("duration_ms", "energy", "danceability", "popularity","liveness","tempo")]
pop_data_normalized <- as.data.frame(lapply(pop_data, function(x) (x - min(x)) / (max(x) - min(x))))
pop_data_with_limits <- rbind(rep(1, ncol(pop_data_normalized)), rep(0, ncol(pop_data_normalized)), pop_data_normalized)
colors_border <- rainbow(nrow(pop_data_normalized))
colors_fill <- adjustcolor(colors_border, alpha.f = 0.3)

radarchart(pop_data_with_limits,
           axistype = 1,
           pcol = colors_border,       
           pfcol = colors_fill,      
           plwd = 2,                   
           plty = 1,                   
           cglcol = "grey",           
           cglty = 1,                
           caxislabels = seq(0, 1, 0.2), 
           cglwd = 0.6,       
           axislabcol = "black",       
           vlcex = 0.8,               
           title = "Radar Chart of 'Pop' Songs"
)

legend("bottomright",
       legend = df_new$track_name,
       col = colors_border,
       lty = 1,
       lwd = 2,
       cex = 0.7,
       box.lty = 0
)



```
#### تفسیر نمودار تار عنکبوتی 
نمودار راداری به‌طور کلی مقایسه‌ای از ویژگی‌های آهنگ‌ها را در یک نمای دو بعدی به نمایش می‌گذارد. هر نقطه‌ای که در یک شعاع مشخص قرار دارد، نشان‌دهنده مقدار آن ویژگی برای آهنگ مورد نظر است.

---

# درباره نویسنده
**امیرعلی سطوتی**  
دانشجوی کارشناسی آمار، دانشگاه فردوسی مشهد

من امیرعلی سطوتی، دانشجوی کارشناسی آمار در دانشگاه فردوسی مشهد هستم. علاقه‌مند به تحلیل داده‌ها و مدل‌سازی آماری می‌باشم. برای اطلاعات بیشتر و مشاهده پروژه‌های عملی‌ام، می‌توانید به پروفایل‌های آنلاین من در لینک‌های زیر مراجعه کنید:

- [LinkedIn](https://www.linkedin.com/in/amirali-satvati/)
- [GitHub](https://github.com/amiralisatvati)

\begin{figure}[ht]
  \centering
  \includegraphics[scale=0.5, keepaspectratio]{C:/Users/WIN10/Desktop/nemone.jpg}
  \label{fig:nemone}
\end{figure}

