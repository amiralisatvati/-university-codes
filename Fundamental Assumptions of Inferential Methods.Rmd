---
title: "Fundamental Assumptions of Inferential Methods"
author: "امیرعلی سطوتی"
output:
  html_document:
    theme: cerulean
    toc: true
    toc_float: true
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

```{r}
data <- read.csv(choose.files())
```

# مقدمه

در این تمرین، داده‌های مربوط به تحقیق درباره تأثیر ساعات مطالعه روزانه بر معدل (GPA) بررسی شده‌اند. هدف اصلی تحلیل این است که رابطه بین ساعات مطالعه (متغیر مستقل) و معدل (متغیر وابسته) مشخص شود و نرمال بودن داده‌ها نیز آزمون گردد.

------------------------------------------------------------------------

```{r}
asmstu <- data[sample(1:nrow(data), 50),]
head(asmstu)
model <- lm(GPA ~ Study_Hours_Per_Day, data = data)
stuGR <- model$res
 head(summary(asmstu))
```

# پذیره زیربنایی اول

فرض می‌شود که رابطه بین متغیرهای مستقل و وابسته خطی است. این پذیره بیان می‌کند که اثر هر متغیر مستقل بر متغیر وابسته از طریق یک معادله خطی بیان می‌شود

## نرمال بودن خطا ها

```{r}


plot(data$Study_Hours_Per_Day,data$GPA)
H <- hist(stuGR, plot = FALSE)
hist(stuGR, xlab = "ساعات مطالعه", 
     ylab = "معدل (GPA)", 
     main = "رابطه ساعات مطالعه و معدل")
lines(H$mids, H$counts, col = "red")
boxplot(stuGR)
```

------------------------------------------------------------------------

## آزمون نرمال بودن

### آزمون کولموگروف اسمیرنوف

```{r}
ks.test(stuGR,pnorm)
```

p-value = 0.5759 بیشتر از الفا هست پس رد نمی شود و ازمون کولموگروف-اسمیرنوف اینجا نشان می دهد که شواهد کافی برای رد نرمال بودن داده‌ها وجود ندارد پس با با توزیع نرمال سازگار هستند.

------------------------------------------------------------------------

### آزمون لیلیفورس

```{r}
ks.test((stuGR- mean(stuGR)) / sd(stuGR),pnorm)
library(nortest)
lillie.test(stuGR)
```

در نتیجه ازمون اچ صفر رد نمی شود پس توزیع نرمال است

------------------------------------------------------------------------

### آزمون شاپیرو-ویلک

```{r}
shapiro.test(stuGR)
qqnorm(stuGR)
```

در آزمون شاپیرو-ویلک نیز اچ فرض صفر رد نمی‌شود

------------------------------------------------------------------------

### آزمون آندرسون-دارلینگ

```{r}
ad.test(stuGR)
```

# پذیره زیربنایی دوم

فرض می‌شود که خطاها یا باقیمانده‌ها دارای توزیع نرمال با میانگین صفر و واریانس ثابت هستند (همسانی واریانس). همچنین، فرض استقلال خطاها نیز در این سطح مطرح است.

```{r,include=FALSE}
library(car)
library(lmtest)
```

## نمودار پراکنش پیش بینی خطا ها

```{r}
model <- lm(GPA ~ Study_Hours_Per_Day, data = data)
plot(fitted(model), resid(model))
```

نمودار پراکنش پیش بینی خطا ها به حالت قیف شکل نیست روند تصائفی است و همگنی واریانس نتیجه گرفت

## ازمون بروش پاگان

```{r}
anova(model)
bptest(model)
```

واریانس خطاها در مدل همسان است (همسانی واریانس وجود دارد). این نشان می‌دهد که مدل رگرسیون خطی شما از نظر فرضیه‌های اساسی مناسب است

# پذیره زیر بنایی سوم

متغیرهای مستقل باید غیر هم‌خطی (Non-collinear) باشند. این بدان معناست که متغیرهای مستقل نباید به صورت خطی به یکدیگر وابسته باشند تا مدل معنادار باقی بماند و تخمین‌ها قابل اعتماد باشند

## نمودار ناخودهمبستگی

```{r}
plot(resid(model),type = "l")
```

## ازمون دوربین-واتسون

```{r}
dwtest(model,alternative = "two.sided")
durbinWatsonTest(model)
```

خودهمبستگی در باقیمانده‌های مدل وجود ندارد مدل رگرسیون شما از این نظر معتبر است و فرضیات استقلال باقیمانده‌ها برقرار است
