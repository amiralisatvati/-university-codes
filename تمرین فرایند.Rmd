---
title: "تحلیل مارکوف و شبیه‌سازی وضعیت‌های مختلف"
author: "امیرعلی سطوتی"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3       # عمق فهرست مطالب (تا سطح 3)
    theme: "cosmo"     # انتخاب تم برای بهبود ظاهر
    highlight: "kate"  # انتخاب استایل رنگی برای کدها
    code_folding: hide # قابلیت جمع و باز کردن بلوک‌های کد
    df_print: "paged"  # جداول به صورت صفحه‌بندی‌شده نمایش داده شوند
---


# مقدمه

این پروژه به شبیه‌سازی و تجزیه‌وتحلیل یک مدل مارکوف با استفاده از ماتریس‌های انتقال مختلف پرداخته است. در این پروژه، سیستم‌های مختلف با استفاده از شبیه‌سازی‌های تصادفی بررسی می‌شوند تا ویژگی‌های مختلف مانند وضعیت‌های جاذب، گذرا و بازگشتی شناسایی شوند.

------------------------------------------------------------------------

# تمرین یک

## قسمت اول

### الف

```{r}
p=matrix(c(0,0,0,0,0,0,0,0,0,0.5,0,0,0,0,1,0.5,0.5,0,0,0,0,1,1,1,0.25,0,0,0 ,1,1,1      ,0.75,0,1,0,1,1,1,1,0,1,0,1,1,1,1,0.5,1,0,1,1,1,1,1,1,1),7,8) 
p


x=c() 
 
x[1]=1 
 
 for(n in 2:101){ 
 
   u=runif(1) 
 
   for(j in 1:5){ 
 
     if(p[x[n-1],j]<=u& u<=p[x[n-1],j+1]) 
 
       x[n]=j}} 
x
```

------------------------------------------------------------------------

### ب

وضعيت های 4 و 5 و 6 گذرا هستند و وضعيت 7 جاذب و وضعيت های 1 و 2 و 3 بازگشتی

خير چون از بعضی وضعيت ها به بعض ی وضعيت ها راهی وجود ندارد \*\*\* \### ج

```{r}

p <- matrix(c(0, 0, 0, 0, 0, 0.5, 1, 0.5, 0.5, 1, 1, 1), 3, 4)

y <- numeric(10000)

for (i in 1:10000) {
  x <- numeric()
  x[1] <- 1
  d <- 0
  n <- 2
  
  while (d == 0) {
    u <- runif(1)
    for (j in 1:3) {
      if (p[x[n - 1], j] <= u & u <= p[x[n - 1], j + 1]) {
        x[n] <- j
      }
    }
    if (x[n] == 1) {
      d <- 1
    }
    n <- n + 1
  }
  
  y[i] <- n - 2
}

mean(y == 5)


```

------------------------------------------------------------------------

##قسمت دو \### دال و ه

```{r message=FALSE, paged.print=FALSE}
p=matrix(c(0,0,0,0,0,1,1/4,0,0,0,1,3/4,0,1,0,1,1,0,1,0,1,1,1/2,1,0,1,1,1,1,1)
,5,6) 


SA = 0
SB = 0
Na = 0
NB = 0
for (i in 1:10000) {
  x = c()
  x[1] = 2
  A = 0
  B = 0
  n = 2
  while (n) {
    u = runif(1)
    for (j in 1:5) {
      if (p[x[n - 1], j] <= u & u <= p[x[n - 1], j + 1]) 
        x[n] = j
    }
    if (x[n] == 5) {
      B = 1
      SB = SB + n - 1
      NB = NB + 1
    }
    if (x[n] == 1) {
      A = 1
      SA = SA + n - 1
      Na = Na + 1
    }
    if (B == 1 | A == 1) break
    n = n + 1
  }
}
SA / Na
SB / NB
Na / 10000
NB / 10000
```

```{r}
SA = 0
SB = 0
Na = 0
NB = 0
for (i in 1:10000) {
  x = c()
  x[1] = 3
  A = 0
  B = 0
  n = 2
  while (n) {
    u = runif(1)
    for (j in 1:5) {
      if (p[x[n - 1], j] <= u & u <= p[x[n - 1], j + 1]) 
        x[n] = j
    }
    if (x[n] == 5) {
      B = 1
      SB = SB + n - 1
      NB = NB + 1
    }
    if (x[n] == 1) {
      A = 1
      SA = SA + n - 1
      Na = Na + 1
    }
    if (B == 1 | A == 1) break
    n = n + 1
  }
}
SA/Na 

```

```{r}
SA = 0
SB = 0
Na = 0
NB = 0
for (i in 1:10000) {
  x = c()
  x[1] = 3
  A = 0
  B = 0
  n = 2
  while (n) {
    u = runif(1)
    for (j in 1:5) {
      if (p[x[n - 1], j] <= u & u <= p[x[n - 1], j + 1]) 
        x[n] = j
    }
    if (x[n] == 5) {
      B = 1
      SB = SB + n - 1
      NB = NB + 1
    }
    if (x[n] == 1) {
      A = 1
      SA = SA + n - 1
      Na = Na + 1
    }
    if (B == 1 | A == 1) break
    n = n + 1
  }
}
SA / Na
SB / NB
Na / 10000
NB / 10000

```

```{R}
SA = 0
SB = 0
Na = 0
NB = 0
for (i in 1:10000) {
  x = c()
  x[1] = 4
  A = 0
  B = 0
  n = 2
  while (n) {
    u = runif(1)
    for (j in 1:5) {
      if (p[x[n - 1], j] <= u & u <= p[x[n - 1], j + 1]) 
        x[n] = j
    }
    if (x[n] == 5) {
      B = 1
      SB = SB + n - 1
      NB = NB + 1
    }
    if (x[n] == 1) {
      A = 1
      SA = SA + n - 1
      Na = Na + 1
    }
    if (B == 1 | A == 1) break
    n = n + 1
  }
}
SB / NB
NB / 10000
```

------------------------------------------------------------------------

# سوال دو

### الف وب

```{r}
p=matrix(c(0,0,0,0,0,1,0.5,0,0,0,1,0.5,1/3,0,0,1,1,2/3,0.5,0,1,1,2/3,0.5,0,1
,1,1,1,1),5,6) 


x = c()
x[1] = 4

for (n in 2:101) {
  u = runif(1)
  for (j in 1:5) {
    if (p[x[n - 1], j] <= u & u <= p[x[n - 1], j + 1]) 
      x[n] = j
  }
}

x

```

وضعيت های 1 و 5 جاذب و وضعيت های 2 و3 و 4 گذرا هستند \*\*\* \### قسمت ج

```{r}
p = matrix(c(0, 0, 0, 0, 0, 1, 0.5, 0, 0, 0, 1, 0.5, 1/3, 0, 0, 1, 1, 2/3, 0.5, 0, 1, 1, 2/3, 0.5, 0, 1, 1, 1, 1, 1), 5, 6)

sa = 0
sb = 0
na = 0
nb = 0

for (i in 1:10000) {
  x = c()
  x[1] = 3
  a = 0
  b = 0
  n = 2
  while (n) {
    u = runif(1)
    for (j in 1:5) {
      if (p[x[n-1], j] <= u & u <= p[x[n-1], j+1]) x[n] = j
    }
    if (x[n] == 1) {
      a = 1
      sa = sa + n - 1
      na = na + 1
    }
    if (x[n] == 5) {
      b = 1
      sb = sb + n - 1
      nb = nb + 1
    }
    if (a == 1 | b == 1) break
    n = n + 1
  }
}

sa / na
sb / nb
na / 10000
nb / 10000

```

------------------------------------------------------------------------

# تمرین سوم

```{r}
y=c()
for(i in 1:10000){
n=0
x=0
while(x<30){
if(runif(1)<0.1)
x=x+1
else
x=x
n=n+1}
y[i]=n}
mean(y)

```

------------------------------------------------------------------------

# تمرین چهارم

```{r}
y=c()
for(i in 1:10000){
  n=1
  x=3
  while(x){
    if(sum(runif(1)<0.75)==1){ 
      x=x+1
    } else {
      x=x-1
    }
    if(x==10|x==0) break
    n=n+1
  }
  y[i]=n
}
mean(y)

```
