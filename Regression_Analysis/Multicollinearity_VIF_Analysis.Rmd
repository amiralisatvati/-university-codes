---
title: "Regression Analysis and Multicollinearity Examination"
author: "Amirali Satvati"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: cerulean
    toc: true
    toc_float: true
    toc_depth: 4
highlight: tango

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

No multicollinearity for predicting Calories Burned as the dependent variable based on weight, workout frequency, and body fat percentage.
Independent variables should not have high correlation with each other.
If independent variables are strongly correlated, regression coefficient estimates become unstable and model interpretation becomes difficult.

# R

#### Loading Data

```{r}
data_gem <- read.csv("C:\\Users\\WIN10\\Desktop\\gem.csv")
m1 <- lm(Calories_Burned ~ Weight..kg. + Workout_Frequency..days.week. + Fat_Percentage, data = data_gem)

```

```{r}
anova(m1)
summary(m1)
```

## Fourth Fundamental Assumption

```{r}
library(car)
library(olsrr)
vif(m1)
ols_vif_tol(m1)
```

Multicollinearity occurs when independent variables in the model are highly correlated with each other. This condition exists when one independent variable can be almost linearly predicted from other variables.

### VIF (Variance Inflation Factor)

Shows the increase in variance of regression coefficients due to multicollinearity.

\begin{aligned}
\text{VIF} &= \frac{1}{1 - R^2} \quad \text{(Variance Inflation Factor)} \\
\end{aligned}

#### Interpretation

VIF = 1: No multicollinearity exists
VIF > 5: Notable multicollinearity exists and should be investigated
VIF > 10: Severe multicollinearity exists and model results may become invalid

### Tolerance

Tolerance is the inverse of VIF and shows how much variance of an independent variable is uniquely explained.

\begin{aligned}
\text{Tolerance} &= 1 - R^2 \quad \text{(Tolerance)}
\end{aligned}

#### Interpretation

If Tolerance < 0.1 indicates severe multicollinearity
Value close to 1 means the variable is almost independent of other variables


# Checking Abnormal Points

```{r}
x <- cbind(c(1), data_gem$Weight..kg. ,data_gem$Workout_Frequency..days.week.,data_gem$Fat_Percentage)

H <- x%*%solve(t(x)%*%x)%*%t(x)
dH <- dim(H)
#diag(H)>2*4/dH
sum((diag(H)>2*4/dH)==TRUE)

```


# Checking Influential Points

```{r}
cii <- 1/4*diag(H)/(1-diag(H))*(resid(m1)/anova(m1)[4,3]^0.5/sqrt(1-diag(H)))^2
sum((cii>qf(0.5,41,dH-4))==T)
sii <- ((dH-4)*anova(m1)[4,3]-resid(m1)^2/(1-diag(H)))/(dH-4-1)
di <- resid(m1)/sii/sqrt(1-diag(H))*sqrt(diag(H)/1-diag(H))
sum((di>2*(4/dH)^0.5)==T)
```

There are influential points, but no data is not influential.
However, 37 points are abnormal.


























