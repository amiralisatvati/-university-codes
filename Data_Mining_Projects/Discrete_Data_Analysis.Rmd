successfully downloaded text file (SHA: ae37fae9cc9641b0e4f20ba8b1f79873b3edc74d)
---
title: "تحلیل داده‌های گسسته: داستان‌ها پشت اعداد"
subtitle: "از مسافران تایتانیک تا ژانرهای موسیقی و خودروها"
author: "امیرعلی سطوتی"
date: "۱۴۰۴/۰۸/۱۰"
output:
  html_document:
    css: "optimized-theme.css"
    theme: default
    highlight: kate
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: true
    number_sections: true
    df_print: paged
    lang: fa
---
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
.profile-container {
  text-align: center;
  margin-top: -20px;
  margin-bottom: 40px;
  animation: fade-up 0.8s ease-out;
}
.profile-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin: 0 10px;
  padding: 10px 25px;
  border-radius: 50px;
  color: white !important;
  text-decoration: none !important;
  font-weight: bold;
  font-family: sans-serif;
  transition: all 0.3s ease;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
.btn-linkedin {
  background: linear-gradient(45deg, #0077b5, #00a0dc);
}
.btn-github {
  background: linear-gradient(45deg, #333, #555);
}
.profile-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 15px rgba(0,0,0,0.2);
  filter: brightness(1.1);
}
.profile-btn i {
  margin-right: 10px;
  font-size: 1.2em;
}
</style>

<div class="profile-container">
  <a href="https://www.linkedin.com/in/amirali-satvati/" target="_blank" class="profile-btn btn-linkedin">
    <i class="fab fa-linkedin"></i> LinkedIn
  </a>
  <a href="https://github.com/amiralisatvati" target="_blank" class="profile-btn btn-github">
    <i class="fab fa-github"></i> GitHub
  </a>
</div>


```{r message=FALSE, warning=FALSE, paged.print=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE, digits = 2)
knitr::knit_hooks$set(inline = function(x) {
  if(is.numeric(x)) {
    round(x, 2)
  }
})
```

```{r}

library(ggplot2)
library(dplyr)
library(treemapify)
library(reshape2)
library(ggiraphExtra)

```

# بخش اول: تایتانیک – چه کسانی نجات یافتند؟


```{r}

data(Titanic)

titanic_df <- as.data.frame(Titanic)


survival_by_class <- titanic_df %>%
  group_by(Class, Survived) %>%
  summarise(Total = sum(Freq), .groups = 'drop')



print(survival_by_class)


ggplot(survival_by_class, aes(x = Class, y = Total, fill = Survived)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "تعداد مسافران نجات‌یافته و غرق‌شده در هر کلاس کشتی",
       x = "کلاس کشتی",
       y = "تعداد مسافر") +
  theme_minimal()

```

<div class="box-result">
  <p>
  <strong>تحلیل نمودار میله‌ای تایتانیک:</strong>
  </p>
  <ul>
    <li>در کلاس درجه یک (1st)، تعداد نجات‌یافتگان به‌طور قابل توجهی بیشتر از کلاس‌های پایین‌تر است؛ این نشان‌دهنده تأثیر <strong>طبقه اجتماعی</strong> بر شانس بقاست.</li>
    <li>در کلاس سوم (3rd)، تعداد غرق‌شدگان بسیار زیاد است که حاکی از دسترسی کمتر این مسافران به امکانات نجات (قایق‌ها) است.</li>
    <li>کلاس خدمه (Crew) نیز توزیع خاص خود را دارد و نشان می‌دهد که حتی پرسنل کشتی نیز مصون از خطر نبوده‌اند.</li>
  </ul>
</div>

# بخش دوم: ژانرهای موسیقی – کدام سبک محبوب‌تر است؟


```{r}
set.seed(123)

genres <- c("Pop", "Rock", "Hip-Hop", "Jazz", "Classical", "EDM")
Popularity_Score <- c(85, 75, 90, 60, 50, 70)
Affect <- c("Positive", "Positive", "Positive", "Calm", "Calm", "Energetic")

music_data <- data.frame(Genre = genres,
                         Popularity_Score = Popularity_Score,
                         Affect = Affect)


print(music_data)


ggplot(music_data, aes(x = Genre, y = Popularity_Score, fill = Genre)) +
  geom_bar(stat = "identity") +
  coord_polar() +
  labs(title = "محبوبیت ژانرهای مختلف موسیقی در Spotify (به صورت Polar Bar)",
       x = "ژانر موسیقی",
       y = "امتیاز محبوبیت") +
  theme_minimal()

```

<div class="box-result">
  <p>
  <strong>برداشت‌ها از نمودار Polar Bar موسیقی:</strong>
  </p>
  <ul>
    <li>ژانر <strong>Hip-Hop</strong> با امتیاز ۹۰، محبوب‌ترین سبک در این مجموعه فرضی است.</li>
    <li>ژانرهای <strong>Pop</strong> و <strong>Rock</strong> نیز در رده‌های بعدی محبوبیت قرار دارند و نشان می‌دهند که موسیقی عامه‌پسند هنوز جایگاه خود را حفظ کرده است.</li>
    <li>ژانر <strong>Classical</strong> اگرچه کم‌طرفدارتر است، اما می‌تواند نماینده سلیقه‌های خاص و مخاطبان محدودتر باشد.</li>
  </ul>
</div>

# بخش سوم: Treemap – زیرژانرهای موسیقی زیر ذره‌بین


```{r}

subgenres <- c("Pop", "Electropop", "Synthpop",
               "Rock", "Hard Rock", "Indie Rock",
               "Hip-Hop", "Trap", "Boom Bap",
               "Jazz", "Smooth Jazz", "Bebop")

streams <- c(250, 180, 150,
             220, 160, 140,
             300, 200, 180,
             130, 90, 80)

main_genre <- c("Pop", "Pop", "Pop",
                "Rock", "Rock", "Rock",
                "Hip-Hop", "Hip-Hop", "Hip-Hop",
                "Jazz", "Jazz", "Jazz")

music_treemap_data <- data.frame(
  Main_Genre = main_genre,
  Subgenre = subgenres,
  Streams_Millions = streams
)

print(music_treemap_data)


ggplot(music_treemap_data, aes(area = Streams_Millions, fill = Main_Genre, label = Subgenre)) +
  geom_treemap() +
  geom_treemap_text(colour = "white", place = "centre", grow = TRUE) +
  labs(title = "Treemap زیرژانرهای موسیقی بر اساس تعداد استریم (میلیون)") +
  theme(legend.position = "bottom")

```

<div class="box-result">
  <p>
  <strong>درک توزیع زیرژانرها در Treemap:</strong>
  </p>
  <ul>
    <li>Rectangles مربوط به زیرژانرهای Hip-Hop (مانند Trap و Boom Bap) بزرگ‌ترند و بیانگر استریم بسیار بالای این سبک‌ها هستند.</li>
    <li>در ژانر Pop، زیرژانری مانند Electropop با استریم ۱۸۰ میلیون، جایگاه میانی اما قابل توجهی دارد.</li>
    <li>زیرژانرهای Jazz مانند Smooth Jazz و Bebop سهم کوچکتری دارند که با ماهیت مخاطبان خاص این سبک هماهنگ است.</li>
  </ul>
</div>

# بخش چهارم: Heatmap – همبستگی ویژگی‌های خودروها (mtcars)


```{r}

cor_matrix <- cor(mtcars)

print(cor_matrix)

cor_melted <- melt(cor_matrix)



head(cor_melted)


ggplot(cor_melted, aes(Var1, Var2, fill = value)) +
  geom_tile() +
  scale_fill_gradient2(low = "red", high = "green", mid = "white", midpoint = 0) +
  labs(title = "نقشه حرارتی (Heatmap) همبستگی ویژگی‌های خودروها در دیتاست mtcars",
       x = "متغیر اول",
       y = "متغیر دوم",
       fill = "ضریب همبستگی") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

<div class="box-result">
  <p>
  <strong>برداشت از Heatmap همبستگی mtcars:</strong>
  </p>
  <ul>
    <li>همبستگی منفی قوی بین <code>mpg</code> (مصرف سوخت) و <code>wt</code> (وزن خودرو) نشان می‌دهد که خودروهای سنگین‌تر، مصرف بیشتری دارند.</li>
    <li>همبستگی مثبت بین <code>hp</code> (قدرت موتور) و <code>disp</code> (حجم موتور) طبیعی است، چون موتورهای حجیم‌تر معمولاً قدرت بیشتری تولید می‌کنند.</li>
    <li>مقادیر نزدیک به صفر در جدول نشان می‌دهد که برخی متغیرها رابطه خطی معناداری با هم ندارند.</li>
  </ul>
</div>

# بخش پنجم: نمودار رادار – مقایسه ویژگی‌های آهنگ‌های پاپ


```{r}

pop_songs <- data.frame(
  Song = c("Song A", "Song B", "Song C", "Song D", "Song E"),
  Danceability = c(0.8, 0.7, 0.9, 0.6, 0.75),
  Energy       = c(0.7, 0.8, 0.9, 0.65, 0.78),
  Valence      = c(0.6, 0.5, 0.8, 0.4, 0.7),
  Acousticness = c(0.2, 0.3, 0.1, 0.35, 0.25),
  Instrumentalness = c(0.05, 0.02, 0.01, 0.03, 0.04),
  Liveness     = c(0.1, 0.15, 0.2, 0.12, 0.18)
)

print(pop_songs)


pop_songs_long <- melt(pop_songs, id.vars = "Song")


ggiraphExtra::ggRadar(pop_songs, aes(group = Song), rescale = TRUE, legend.position = "bottom") +
  labs(title = "نمودار Radar برای مقایسه ویژگی‌های مختلف آهنگ‌های پاپ")

```

<div class="box-result">
  <p>
  <strong>جمع‌بندی تحلیل رادار آهنگ‌های پاپ:</strong></p>
  <ul>
    <li>آهنگ‌هایی با Danceability و Energy بالا مناسب‌تر برای پخش در باشگاه‌ها و مهمانی‌ها هستند.</li>
    <li>آهنگ‌هایی با Acousticness بالاتر، حس آرام‌تر و آکوستیک‌تری دارند و برای فضاهای خلوت‌تر مناسب‌اند.</li>
    <li>Instrumentalness نزدیک به صفر، نشان می‌دهد که بیشتر آهنگ‌ها دارای بخش وکال (خواننده) هستند و صرفاً قطعات بی‌کلام نیستند.</li>
  </ul>
</div>



